# Scripts р╕кр╕│р╕лр╕гр╕▒р╕Ъ Migration р╕Вр╣Йр╕нр╕бр╕╣р╕е

## ЁЯУЛ migrate-students.js

Script р╕кр╕│р╕лр╕гр╕▒р╕Ъ migrate р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Щр╕┤р╕кр╕┤р╕Хр╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М Excel р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ

### р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Dependencies

```bash
npm install xlsx
# р╕лр╕гр╕╖р╕н
pnpm add xlsx
```

### р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М Excel р╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ъ

р╣Др╕Яр╕ер╣М Excel р╕Др╕зр╕гр╕бр╕╡ columns р╕Фр╕▒р╕Зр╕Щр╕╡р╣Й (р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Чр╕▒р╣Йр╕Зр╕ар╕▓р╕йр╕▓р╣Др╕Чр╕вр╣Бр╕ер╕░р╕нр╕▒р╕Зр╕Бр╕др╕й):

| Column (TH) | Column (EN) | Required | Description |
|-------------|-------------|----------|-------------|
| р╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Х | Student ID | тЬЕ | р╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Х 8-10 р╕лр╕ер╕▒р╕Б |
| р╕Др╕│р╕Щр╕│р╕лр╕Щр╣Йр╕▓ | Title | тЭМ | р╕Щр╕▓р╕в, р╕Щр╕▓р╕З, р╕Щр╕▓р╕Зр╕кр╕▓р╕з |
| р╕Кр╕╖р╣Ир╕н | First Name | тЬЕ | р╕Кр╕╖р╣Ир╕нр╕Ир╕гр╕┤р╕З |
| р╕Щр╕▓р╕бр╕кр╕Бр╕╕р╕е | Last Name | тЬЕ | р╕Щр╕▓р╕бр╕кр╕Бр╕╕р╕е |
| р╕Др╕Ур╕░ | Faculty | тЭМ | р╕Кр╕╖р╣Ир╕нр╕Др╕Ур╕░ |
| р╕кр╕▓р╕Вр╕▓ | Department | тЭМ | р╕Кр╕╖р╣Ир╕нр╕кр╕▓р╕Вр╕▓р╕зр╕┤р╕Кр╕▓ |
| р╕Кр╕▒р╣Йр╕Щр╕Ыр╕╡ | Year | тЭМ | р╕Кр╕▒р╣Йр╕Щр╕Ыр╕╡ |

### р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

1. **р╕зр╕▓р╕Зр╣Др╕Яр╕ер╣М Excel р╣Гр╕Щ folder scripts/**
   ```
   scripts/
   тФЬтФАтФА Std_R01_01 (12).xlsx
   тФЬтФАтФА Std_R01_01 (13).xlsx
   тФФтФАтФА migrate-students.js
   ```

2. **р╣Бр╕Бр╣Йр╣Др╕Вр╕гр╕▓р╕вр╕Кр╕╖р╣Ир╕нр╣Др╕Яр╕ер╣Мр╣Гр╕Щ script** (р╕Цр╣Йр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г)
   ```javascript
   const excelFiles = [
       'Std_R01_01 (12).xlsx',
       'Std_R01_01 (13).xlsx',
       // р╣Ар╕Юр╕┤р╣Ир╕бр╣Др╕Яр╕ер╣Мр╕нр╕╖р╣Ир╕Щр╣Ж р╕Хр╕▓р╕бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г
   ];
   ```

3. **р╕гр╕▒р╕Щ script**
   ```bash
   npm run migrate-students
   # р╕лр╕гр╕╖р╕н
   pnpm migrate-students
   # р╕лр╕гр╕╖р╕н
   node scripts/migrate-students.js
   ```

### р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М

Script р╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕Фр╕▒р╕Зр╕Щр╕╡р╣Й:

```
ЁЯЪА р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ Migration р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Щр╕┤р╕кр╕┤р╕Х

ЁЯУБ р╕Бр╕│р╕ер╕▒р╕Зр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╣Др╕Яр╕ер╣М: Std_R01_01 (12).xlsx
тФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФА
ЁЯУЦ р╕нр╣Ир╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М: Std_R01_01 (12).xlsx
ЁЯУК р╕Юр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е 150 р╕гр╕▓р╕вр╕Бр╕▓р╕г
ЁЯУЛ Columns: р╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Х, р╕Др╕│р╕Щр╕│р╕лр╕Щр╣Йр╕▓, р╕Кр╕╖р╣Ир╕н, р╕Щр╕▓р╕бр╕кр╕Бр╕╕р╕е, р╕Др╕Ур╕░, р╕кр╕▓р╕Вр╕▓

тЬЕ р╕кр╕гр╣Йр╕▓р╕Зр╕Щр╕┤р╕кр╕┤р╕Х 65123456 - р╕кр╕бр╕Кр╕▓р╕в р╣Гр╕Ир╕Фр╕╡
тЬЕ р╕кр╕гр╣Йр╕▓р╕Зр╕Щр╕┤р╕кр╕┤р╕Х 65123457 - р╕кр╕бр╕лр╕Нр╕┤р╕З р╕гр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щ
тЪая╕П  р╕Щр╕┤р╕кр╕┤р╕Х 65123458 р╕бр╕╡р╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕гр╕░р╕Ър╕Ър╣Бр╕ер╣Йр╕з

============================================================
ЁЯУК р╕кр╕гр╕╕р╕Ыр╕Ьр╕ер╕Бр╕▓р╕г Migration
============================================================
тЬЕ р╕кр╕гр╣Йр╕▓р╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╣Гр╕лр╕бр╣И: 148 р╕Др╕Щ
тЪая╕П  р╕Вр╣Йр╕▓р╕бр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Чр╕╡р╣Ир╕бр╕╡р╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕з: 2 р╕Др╕Щ
ЁЯУЭ р╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф: 150 р╕гр╕▓р╕вр╕Бр╕▓р╕г
============================================================

ЁЯТб р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕: р╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕Др╕╖р╕нр╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Х
```

### р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕кр╕гр╣Йр╕▓р╕Зр╣Гр╕Щр╕гр╕░р╕Ър╕Ъ

р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕ер╕░р╕Щр╕┤р╕кр╕┤р╕Х script р╕Ир╕░р╕кр╕гр╣Йр╕▓р╕З:

- **Username**: р╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Х
- **Password**: р╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Х (р╣Ар╕Вр╣Йр╕▓р╕гр╕лр╕▒р╕кр╕Фр╣Йр╕зр╕в bcrypt)
- **Role**: student
- **Email**: {р╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Х}@ku.th
- **Status**: active
- **Membership**: member

### р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е

р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Б migrate р╣Ар╕кр╕гр╣Зр╕И р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Др╕Фр╣Йр╕Чр╕╡р╣И:

1. **Database**
   ```sql
   SELECT * FROM users WHERE role = 'student' ORDER BY registered_at DESC;
   ```

2. **Admin Dashboard**
   - р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╕Фр╣Йр╕зр╕в superAdmin
   - р╣Др╕Ыр╕Чр╕╡р╣И User Management
   - р╕Бр╕гр╕нр╕З role = student

### р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕

- тЪая╕П Script р╕Ир╕░р╕Вр╣Йр╕▓р╕бр╕Щр╕┤р╕кр╕┤р╕Хр╕Чр╕╡р╣Ир╕бр╕╡р╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Хр╕Лр╣Йр╕│р╣Гр╕Щр╕гр╕░р╕Ър╕Ъ
- ЁЯФТ р╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щр╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕Др╕╖р╕нр╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Х (р╕Др╕зр╕гр╣Гр╕лр╣Йр╕Щр╕┤р╕кр╕┤р╕Хр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щр╕лр╕ер╕▒р╕Зр╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╕Др╕гр╕▒р╣Йр╕Зр╣Бр╕гр╕Б)
- ЁЯУз Email р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╣Ар╕Ыр╣Зр╕Щ {р╕гр╕лр╕▒р╕кр╕Щр╕┤р╕кр╕┤р╕Х}@ku.th (р╕Др╕зр╕гр╣Гр╕лр╣Йр╕Щр╕┤р╕кр╕┤р╕Хр╕нр╕▒р╕Ыр╣Ар╕Фр╕Х email р╕Ир╕гр╕┤р╕З)
- ЁЯФД р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕гр╕▒р╕Щ script р╕Лр╣Йр╕│р╣Др╕Фр╣Йр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Бр╕гр╕░р╕Чр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Фр╕┤р╕б

### Troubleshooting

**р╕Ыр╕▒р╕Нр╕лр╕▓: Cannot find module 'xlsx'**
```bash
npm install xlsx
```

**р╕Ыр╕▒р╕Нр╕лр╕▓: Cannot find module '@prisma/client'**
```bash
npx prisma generate
```

**р╕Ыр╕▒р╕Нр╕лр╕▓: р╣Др╕бр╣Ир╕Юр╕Ър╣Др╕Яр╕ер╣М Excel**
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Др╕Яр╕ер╣Мр╕нр╕вр╕╣р╣Ир╣Гр╕Щ folder scripts/
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Кр╕╖р╣Ир╕нр╣Др╕Яр╕ер╣Мр╕зр╣Ир╕▓р╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З

**р╕Ыр╕▒р╕Нр╕лр╕▓: Column names р╣Др╕бр╣Ир╕Хр╕гр╕Зр╕Бр╕▒р╕Щ**
- р╕Фр╕╣ log р╕Чр╕╡р╣Ир╣Бр╕кр╕Фр╕З "ЁЯУЛ Columns:" р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣ column names р╕Чр╕╡р╣Ир╕Юр╕Ъ
- р╣Бр╕Бр╣Йр╣Др╕В mapping р╣Гр╕Щ script р╕Хр╕▓р╕бр╕Кр╕╖р╣Ир╕н column р╕Чр╕╡р╣Ир╣Бр╕Чр╣Йр╕Ир╕гр╕┤р╕З
