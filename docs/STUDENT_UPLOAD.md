# คู่มือการอัพโหลดข้อมูลนิสิต

## การเข้าถึงหน้าอัพโหลด

1. เข้าสู่ระบบด้วยบัญชี Admin หรือ Super Admin
2. ไปที่ Admin Dashboard
3. คลิกที่การ์ด "อัพโหลดข้อมูลนิสิต" หรือเข้าผ่าน URL: `/admin/students/upload`

## รูปแบบไฟล์ Excel

ไฟล์ Excel ต้องมี columns ดังนี้:

| Column Name | ความหมาย | จำเป็น | รูปแบบ |
|------------|---------|--------|--------|
| รหัสนิสิต | รหัสนิสิต | ✅ | ตัวเลข 8-10 หลัก |
| คำนำหน้าชื่อ(ไทย) | คำนำหน้าชื่อ | ❌ | นาย, นางสาว, ฯลฯ |
| ชื่อ(ไทย) | ชื่อจริง | ✅ | ข้อความ |
| นามสกุล(ไทย) | นามสกุล | ✅ | ข้อความ |
| E-mail | อีเมล | ❌ | รูปแบบอีเมล |
| โทรศัพท์มือถือ | เบอร์โทรศัพท์ | ❌ | 0XXXXXXXXX (10 หลัก) |
| คณะ/หน่วยงานที่เทียบเท่า | ชื่อคณะ | ❌ | ข้อความ |
| ชื่อภาควิชา | ชื่อภาควิชา | ❌ | ข้อความ |

## กฎการตรวจสอบข้อมูล

### รหัสนิสิต
- ต้องเป็นตัวเลข 8-10 หลัก
- ต้องไม่ซ้ำกับที่มีอยู่ในระบบ (ถ้าไม่เลือก "อัปเดตข้อมูลเดิม")

### อีเมล
- ถ้าไม่มีหรือไม่ถูกต้อง จะสร้างเป็น `รหัสนิสิต@ku.th` อัตโนมัติ

### เบอร์โทรศัพท์
- ต้องเป็นรูปแบบ 0XXXXXXXXX (10 หลัก)
- ถ้าไม่ถูกต้องจะข้ามการบันทึกเบอร์โทร

### รหัสผ่านเริ่มต้น
- รหัสผ่านเริ่มต้นจะเป็นรหัสนิสิต
- นิสิตควรเปลี่ยนรหัสผ่านหลังเข้าสู่ระบบครั้งแรก

## ตัวเลือกการอัพโหลด

### อัปเดตข้อมูลนิสิตที่มีอยู่แล้ว
- ✅ เปิด: จะอัปเดตข้อมูล (ชื่อ, นามสกุล, เบอร์โทร) ของนิสิตที่มีรหัสนิสิตซ้ำ
- ❌ ปิด: จะข้ามนิสิตที่มีรหัสนิสิตซ้ำ

## ผลลัพธ์การอัพโหลด

หลังจากอัพโหลดเสร็จ จะแสดงสรุปผล:

- **สร้างใหม่**: จำนวนนิสิตที่สร้างใหม่
- **อัปเดต**: จำนวนนิสิตที่อัปเดตข้อมูล
- **ข้าม**: จำนวนนิสิตที่ข้ามไป (มีอยู่แล้วและไม่เลือกอัปเดต)
- **ข้อผิดพลาด**: รายการข้อผิดพลาดที่เกิดขึ้น (ถ้ามี)

## ตัวอย่างไฟล์ Excel

```
รหัสนิสิต | คำนำหน้าชื่อ(ไทย) | ชื่อ(ไทย) | นามสกุล(ไทย) | E-mail | โทรศัพท์มือถือ | คณะ/หน่วยงานที่เทียบเท่า | ชื่อภาควิชา
----------|------------------|----------|--------------|--------|----------------|------------------------|-------------
65010001  | นาย              | สมชาย    | ใจดี         | somchai@ku.th | 0812345678 | วิศวกรรมศาสตร์ | วิศวกรรมคอมพิวเตอร์
65010002  | นางสาว           | สมหญิง   | รักดี        | somying@ku.th | 0823456789 | วิทยาศาสตร์ | วิทยาการคอมพิวเตอร์
```

## หมายเหตุ

- ระบบจะประมวลผลข้อมูลเป็น batch (100 รายการต่อครั้ง) เพื่อประสิทธิภาพ
- การอัพโหลดไฟล์ขนาดใหญ่อาจใช้เวลาสักครู่
- ควรตรวจสอบข้อมูลในไฟล์ให้ถูกต้องก่อนอัพโหลด
- สามารถอัพโหลดได้หลายครั้ง โดยระบบจะจัดการข้อมูลซ้ำให้อัตโนมัติ

## การแก้ไขปัญหา

### ไฟล์อัพโหลดไม่สำเร็จ
- ตรวจสอบว่าไฟล์เป็น .xlsx หรือ .xls
- ตรวจสอบว่า column names ตรงกับที่กำหนด
- ตรวจสอบว่ามีข้อมูลในไฟล์

### ข้อมูลบางรายการถูกข้าม
- ตรวจสอบรหัสนิสิตว่าเป็นตัวเลข 8-10 หลัก
- ตรวจสอบว่ามีชื่อและนามสกุล
- ดูรายละเอียดข้อผิดพลาดในส่วน "ข้อผิดพลาด"

### เบอร์โทรไม่ถูกบันทึก
- ตรวจสอบรูปแบบเบอร์โทร (ต้องเป็น 0XXXXXXXXX)
- ตรวจสอบว่าเบอร์โทรไม่ซ้ำกับผู้ใช้อื่น
